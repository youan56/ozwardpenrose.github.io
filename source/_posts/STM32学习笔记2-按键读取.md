---
title: STM32学习笔记2_按键读取
toc: true
abbrlink: 52169
tags: 单片机
categories:
  - 嵌入式
  - 软件
date: 2020-04-02 19:06:36
---

## 变量类型

在上次实验中，我们用到的函数类型为void，使用到的相关函数变量只有GPIO指针和相对应的GPIO结构体，在进行这个实验之前，我们需要了解STM32的各种变量，方便我们使用和编写各种函数。

STM32中一共有24个变量类型，和普通的C语言的变量不一样，库函数中对这些变量进行了宏定义，我们调用时需要了解这些变量从而进行合理调用。

![24种变量.png](https://s1.ax1x.com/2020/04/02/GY16zT.png)

可以看到，其实32的库函数对各种变量的封装特别合理，命名中还包含了变量长度，命名中含有const的就是只读权限的变量。

## 按键读取

其实机械按键常有一个问题就是消抖，硬件上常常采用并联电容的方式进行消抖，软件上通常采用时延的方式进行消抖，两种方式达到的目的都是一样的：在按键机械抖动的过程中不出现误判键值和按键状态，本次实验中按键采用了并联一个电容的方式进行消抖，进行了硬件消抖就不引入时延消抖了。

按键读取中必须记得将引脚设置成浮空输入，关于引脚模式的设置在上一次中已经提及。

到这个内容，我们需要了解所有与GPIO相关的库函数的用法了，不能只满足于输入输出。

关于这个我们需要的参考资料叫做《STM32固件库使用手册》，它是固件库编程中必不可少的资料。

关于GPIO的所有函数说明：

![GPIO说明.png](https://s1.ax1x.com/2020/04/02/GY3w6O.png)

关注以下读取引脚值的函数即可解决按键读取问题。

这个内容比较少，代码结构与LED的代码几乎相同。

代码见Github： [按键读取](https://github.com/OzwardPenrose/STM32F10x-2) 

## 参考资料
> - STM32F103硬件手册
> - [正点原子官方资料](http://www.stmcu.org.cn/module/forum/thread-615919-1-1.html)
